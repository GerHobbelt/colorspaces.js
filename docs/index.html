<!doctype html>
<head>
  <meta charset="utf-8">
  <title>colorspaces.js</title>
  <meta name="description" content="colorspaces.js - a tiny jQuery library for manipulating colors">
  <meta name="author" content="Alexei Boronine">
  <link href='http://fonts.googleapis.com/css?family=Droid+Sans+Mono|Droid+Serif' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <a href="https://github.com/boronine/colorspaces.js"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
  <div id="content">
    <h1 id="colorspaces-js">colorspaces.js</h1>
<p>A tiny JavaScript and <a href="http://nodejs.org">Node.js</a> library for manipulating colors. Works as a <a href="http://learnboost.github.com/stylus">Stylus</a> plugin!</p>
<p>RGB, the color space we use here on the web is based on display technology, not human color perception. Most meaningful color operations are performed on colors in other color spaces, such as <a href="http://en.wikipedia.org/wiki/CIE_1931_color_space">CIEXYZ</a> or <a href="http://en.wikipedia.org/wiki/CIELUV">CIELUV</a>. Read more about color spaces in <a href="http://boronine.com/2012/03/26/Color-Spaces-for-Human-Beings/">my blog post</a>.</p>
<h2 id="installation">Installation</h2>
<p>On the server, <code>npm install colorspaces</code>.</p>
<p>On the client, use the latest <a href="https://raw.githubusercontent.com/boronine/colorspaces.js/master/colorspaces.js">colorspaces.js</a> or <a href="https://raw.githubusercontent.com/boronine/colorspaces.js/master/colorspaces.min.js">colorspaces.min.js</a>.</p>
<h2 id="basic-use">Basic Use</h2>
<p><code>colorspaces.make_color</code> takes two arguments: the name of the color space and an array of values representing the color in the color space.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> red = $.colorspaces.make_color(<span class="hljs-string">'sRGB'</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]);
<span class="hljs-keyword">var</span> green = $.colorspaces.make_color(<span class="hljs-string">'hex'</span>, <span class="hljs-string">'#00ff00'</span>);
<span class="hljs-keyword">var</span> blue = $.colorspaces.make_color(<span class="hljs-string">'CIEXYZ'</span>, [<span class="hljs-number">0.1805</span>, <span class="hljs-number">0.0722</span>, <span class="hljs-number">0.9505</span>]);
</code></pre>
<p>The returned object has a method, <code>as</code>, that takes the name of a color space as its only argument and returns the coordinates of the color in that color space as an array.</p>
<pre><code class="lang-javascript">&gt; red.as(<span class="hljs-string">'CIELUV'</span>)
[ <span class="hljs-number">53.23288178584245</span>, <span class="hljs-number">175.05303573649485</span>, <span class="hljs-number">37.75050503266512</span> ]
&gt; blue.as(<span class="hljs-string">'hex'</span>)
<span class="hljs-string">'#0000ff'</span>
</code></pre>
<p>These color objects also support two methods, both returning a boolean: <code>is_displayable</code> and <code>is_visible</code>. The first one determines whether the color is within the sRGB gamut and the second determines whether the color is within the CIE XYZ gamut. Note that both of these methods round the resulting values to three decimal spaces before checking whether they fit into their range; this is a useful policy because of rounding errors.</p>
<h2 id="lower-level">Lower Level</h2>
<p>If you need to do many color conversions per second, you can optimize by using a low-level function <code>converter</code> that takes two color space names as arguments and returns a converter function.</p>
<pre><code class="lang-javascript">&gt; <span class="hljs-keyword">var</span> conv = colorspaces.converter(<span class="hljs-string">'CIELUV'</span>, <span class="hljs-string">'hex'</span>)
&gt; conv([<span class="hljs-number">53.233</span>, <span class="hljs-number">175.053</span>, <span class="hljs-number">37.75</span>])
<span class="hljs-string">'#ff0000'</span>
</code></pre>
<h2 id="stylus-support">Stylus Support</h2>
<p>You can use colorspaces.js in you Stylus stylesheets. From the command line, you have to run Stylus like this:</p>
<pre><code class="lang-bash">$ stylus -u colorspaces &lt; in.styl
</code></pre>
<p>Or if you are using it as middleware:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> colorspaces = <span class="hljs-built_in">require</span>(<span class="hljs-string">'colorspaces'</span>);
app.use(stylus.middleware({
  src: __dirname + <span class="hljs-string">'/app/views'</span>,
  dest: __dirname + <span class="hljs-string">'/public'</span>,
  compile: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(str, path)</span> </span>{
    <span class="hljs-keyword">return</span> stylus(str)
      .set(<span class="hljs-string">'filename'</span>, path)
      .use(colorspaces());
  }
});
</code></pre>
<p>Now you have access to several functions that take numerical values and return a Stylus color. All color spaces below except for <code>hex</code> and <code>sRGB</code> are supported in the Stylus plugin. The Stylus function names match the color space names.</p>
<pre><code>.someclass
  color CIELCH(20.470, 74.265, 314.113)
</code></pre><p>You can still modify its opacity with Stylus&#39; <code>rgba</code> function:</p>
<pre><code>.someclass
  color rgba(CIELCH(20.470, 74.265, 314.113), 0.5)
</code></pre><h2 id="supported-color-spaces">Supported Color Spaces</h2>
<ul>
<li><a href="http://en.wikipedia.org/wiki/SRGB"><code>sRGB</code></a>: Standard RGB, the color space used on the web. All values range between 0 and 1. Be careful, rounding errors can result in values just outside this range.</li>
<li><a href="http://en.wikipedia.org/wiki/CIE_1931_color_space"><code>CIEXYZ</code></a>: One of the first mathematically defined color spaces. Values range between 0 and 0.95047, 1.0 and 1.08883 for X, Y and Z respectively. These three numbers together define the white point, which can be different depending on the chosen illuminant. The commonly used <a href="http://en.wikipedia.org/wiki/Illuminant_D65">illuminant D65</a> was chosen for this project.</li>
<li><code>CIExyY</code>: Normalized version of the above.</li>
<li><a href="http://en.wikipedia.org/wiki/Lab_color_space"><code>CIELAB</code></a>: A color space made for perceptual uniformity. Recommended for characterization of color surfaces and dyes. L is lightness, spans from 0 to 100.</li>
<li><code>CIELCH</code>: A cylindrical representation of CIELAB. L is lightness, C is chroma (think saturation) and H is hue. H spans from 0 to 360.</li>
<li><a href="http://en.wikipedia.org/wiki/CIELUV"><code>CIELUV</code></a>: Another color space made for perceptual uniformity. Recommended for characterization of color displays.</li>
<li><code>CIELCHuv</code>: Same as CIELCH, but based on CIELUV.</li>
<li><code>hex</code>: A representation of sRGB.</li>
</ul>
<h2 id="development">Development</h2>
<p>Run <code>npm install</code> to install everything necessary to build and test the repo.</p>
<p>To build: <code>cake build:js</code>.</p>
<p>To build documentation: <code>cake build:docs</code>.</p>
<p>To test: <code>coffee tests.coffee</code>.</p>

    <footer>
    &copy; Copyright 2014 by Alexei Boronine
    </footer>
  </div>
  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-26004435-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script>
</body>
</html>
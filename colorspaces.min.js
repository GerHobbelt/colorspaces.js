(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=Array.prototype.slice;b=function(a,b){var c,d,e;d=0;for(c=0,e=a.length-1;0>e?c>=e:c<=e;0>e?c--:c++)d+=a[c]*b[c];return d},i=.95047,j=1,k=1.08883,g=4*i/(i+15*j+3*k),h=9*j/(i+15*j+3*k),e=.008856,f=903.3,c=function(a){return a>e?Math.pow(a,1/3):7.787*a+16/116},d=function(a){return Math.pow(a,3)>e?Math.pow(a,3):(116*a-16)/f},a={from_CIEXYZ:{to_hex:function(){var b,c,d,e;return c=1>arguments.length?[]:o.call(arguments,0),b=(d=a.from_CIEXYZ).to_sRGB.apply(d,c),(e=a.from_sRGB).to_hex.apply(e,b)},to_sRGB:function(){var a,c,d,e,f,g;return d=1>arguments.length?[]:o.call(arguments,0),c=[[3.2406,-1.5372,-0.4986],[-0.9689,1.8758,.0415],[.0557,-0.204,1.057]],a=function(a){var b;return b=.055,a>.0031308?1.055*Math.pow(a,1/2.4)-.055:12.92*a},g=a(b(c[0],d)),f=a(b(c[1],d)),e=a(b(c[2],d)),[g,f,e]},to_CIExyY:function(a,b,c){var d;return d=a+b+c,d===0?[0,0,b]:[a/d,b/d,b]},to_CIELAB:function(a,b,d){var e,f,g,h,l,m;return e=c(a/i),f=c(b/j),g=c(d/k),h=116*f-16,l=500*(e-f),m=200*(f-g),[h,l,m]},to_CIELUV:function(a,b,d){var e,f,i,k,l;return e=4*a/(a+15*b+3*d),f=9*b/(a+15*b+3*d),i=116*c(b/j)-16,i===0?[0,0,0]:(k=13*i*(e-g),l=13*i*(f-h),[i,k,l])},to_CIELCH:function(){var b,c,d,e;return c=1>arguments.length?[]:o.call(arguments,0),b=(d=a.from_CIEXYZ).to_CIELAB.apply(d,c),(e=a.from_CIELAB).to_CIELCH.apply(e,b)},to_CIEXYZ:function(){var a;return a=1>arguments.length?[]:o.call(arguments,0),a}},from_sRGB:{to_CIEXYZ:function(a,c,d){var e,f,g,h,i,j;return g=function(a){var b;return b=.055,a>.04045?Math.pow((a+b)/(1+b),2.4):a/12.92},e=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],f=[g(a),g(c),g(d)],h=b(e[0],f),i=b(e[1],f),j=b(e[2],f),[h,i,j]},to_hex:function(){var a,b,c,d,e;c=1>arguments.length?[]:o.call(arguments,0),b="#";for(d=0,e=c.length;d<e;d++)a=c[d],a=Math.round(a*255).toString(16),a.length===1&&(a="0"+a),b+=a;return b}},from_CIExyY:{to_CIEXYZ:function(a,b,c){var d,e;return b===0?[0,0,0]:(d=a*c/b,e=(1-a-b)*c/b,[d,c,e])}},from_CIELUV:{to_CIEXYZ:function(a,b,c){var e,f,i,k,l,m;return a===0?[0,0,0]:(i=d((a+16)/116),e=b/(13*a)+g,f=c/(13*a)+h,l=i*j,k=0-9*l*e/((e-4)*f-e*f),m=(9*l-15*f*l-f*k)/(3*f),[k,l,m])}},from_CIELAB:{to_CIEXYZ:function(a,b,c){var e,f,g,h,l,m;return f=(a+16)/116,g=f-c/200,e=b/500+f,h=i*d(e),l=j*d(f),m=k*d(g),[h,l,m]},to_CIELCH:function(a,b,c){var d,e,f;return d=Math.pow(Math.pow(b,2)+Math.pow(c,2),.5),f=Math.atan2(c,b),e=f*360/2/Math.PI,e<0&&(e=360+e),[a,d,e]}},from_CIELCH:{to_CIELAB:function(a,b,c){var d,e,f;return f=c/360*2*Math.PI,d=Math.cos(f)*b,e=Math.sin(f)*b,[a,d,e]},to_CIEXYZ:function(){var b,c,d,e;return c=1>arguments.length?[]:o.call(arguments,0),b=(d=a.from_CIELCH).to_CIELAB.apply(d,c),(e=a.from_CIELAB).to_CIEXYZ.apply(e,b)}},from_hex:{to_sRGB:function(a){var b,c,d;return a.charAt(0)==="#"&&(a=a.substring(1,7)),d=a.substring(0,2),c=a.substring(2,4),b=a.substring(4,6),[d,c,b].map(function(a){return parseInt(a,16)/255})},to_CIEXYZ:function(b){var c,d;return c=a.from_hex.to_sRGB(b),(d=a.from_sRGB).to_CIEXYZ.apply(d,c)}}},m=function(a,b){var c;return c=Math.pow(10,b),Math.round(a*c)/c},n=function(a,b){var c,d,e,f;if(a==="sRGB")e=[[0,1],[0,1],[0,1]],b=function(){var a,c,e;e=[];for(a=0,c=b.length;a<c;a++)d=b[a],e.push(m(d,4));return e}();else if(a==="CIEXYZ")e=[[0,.9505],[0,1],[0,1.089]],b=function(){var a,c,e;e=[];for(a=0,c=b.length;a<c;a++)d=b[a],e.push(m(d,4));return e}();else return!0;if(b.length!==e.length)return!1;for(c=0,f=b.length-1;0>f?c>=f:c<=f;0>f?c--:c++)if(b[c]<e[c][0]||b[c]>e[c][1])return!1;return!0},l=typeof exports!="undefined"&&exports!==null?exports:{},l.make_color=function(b,c){var d,e;b==="hex"&&(c=[c]);if(!n(b,c))throw new Error("Color is out of the gamut of the given color space");d=(e=a["from_"+b]).to_CIEXYZ.apply(e,c);if(!n("CIEXYZ",d))throw new Error("Invalid color");return{as:function(b){var c,e;c=(e=a.from_CIEXYZ)["to_"+b].apply(e,d);if(!n(b,c))throw new Error("Color is out of the gamut of the requested color space");return c}}},typeof jQuery!="undefined"&&jQuery!==null&&(jQuery.colorspaces=l)}).call(this)